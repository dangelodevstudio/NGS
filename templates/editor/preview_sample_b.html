{% load static %}
<div class="pdf-document" data-page-width-mm="190.5">
    <!-- PAGE 01: CAPA -->
    <div class="pdf-page page-01" style="background-image: url('{{ bg_pages.0|default:'/static/editor/img/templates/laudo144_pg01.png' }}');">
        <div class="field field-p1-name txt-value">
            <strong>Nome:</strong> {{ patient_name }}
        </div>
        <div class="field field-p1-birth txt-value">
            <strong>Data de Nascimento:</strong> {{ patient_birth_date_cover }}
        </div>
        <div class="field field-p1-code txt-value">
            <strong>Código ID:</strong> {{ patient_code_cover }}
        </div>
    </div>

    <!-- PAGE 02: HEADER + DADOS + RESULTADO PRINCIPAL + RESULTADOS + INTERPRETAÇÃO (parte 1) -->
    <div class="pdf-page page-02" style="background-image: url('{{ bg_pages.1|default:'/static/editor/img/templates/laudo144_pg02.png' }}');">
        {% include 'editor/_header_patient.html' with page='p2' %}
        
        <!-- Bloco DADOS -->
        <div class="field field-p2-requester txt-value"><strong>Solicitante:</strong> {{ requester_display|default:requester_name }}</div>
        <div class="field field-p2-sample txt-value"><strong>Amostra:</strong> {{ sample_display|default:sample_description }}</div>
        <div class="field field-p2-clinical box txt-paragraph"><strong>Indicação clínica:</strong> {{ clinical_indication }}</div>
        <div class="field field-p2-exam txt-value"><strong>Nome do exame:</strong> {{ exam_name }}</div>
        
        <!-- Linha do RESULTADO PRINCIPAL -->
        <div class="field field-p2-gene txt-table">{{ main_gene }}</div>
        <div class="field field-p2-transcript txt-table">{{ main_transcript }}</div>
        <div class="field field-p2-variant-c txt-table">
            {{ main_variant_c }}<br>{{ main_variant_p }}
        </div>
        <div class="field field-p2-dbsnp txt-table">{{ main_dbsnp }}</div>
        <div class="field field-p2-zygosity txt-table">{{ main_zygosity }}</div>
        <div class="field field-p2-inheritance txt-table">{{ main_inheritance }}</div>
        <div class="field field-p2-classification txt-table">{{ main_classification }}</div>
        <div class="field field-p2-condition txt-table">Condição: {{ main_condition }}</div>
        
        <!-- Bloco RESULTADOS (texto curto) -->
        <div class="field field-p2-results box txt-paragraph">{{ main_result_intro }}</div>
        
        <!-- Bloco INTERPRETAÇÃO (parte 1) -->
        <div class="field field-p2-interpretation box txt-paragraph">
            {{ interpretation_p2|linebreaksbr }}
        </div>
        {% include 'editor/_footer_professionals.html' %}
    </div>

    <!-- PAGE 03: INTERPRETAÇÃO (parte 2) + ACHADOS ADICIONAIS + Tabela VUS -->
    <div class="pdf-page page-03 {% if interpretation_p3 %}has-interpretation{% else %}no-interpretation{% endif %}" style="background-image: url('{{ bg_pages.2|default:'/static/editor/img/templates/laudo144_pg03.png' }}');">
        {% include 'editor/_header_patient.html' with page='p3' %}
        
        <!-- Continuação da INTERPRETAÇÃO -->
        <div class="field field-p3-interpretation box txt-paragraph">
            {{ interpretation_p3|linebreaksbr }}
        </div>
        
        <!-- Bloco ACHADOS ADICIONAIS -->
        <div class="field field-p3-additional box txt-paragraph">
            {{ additional_findings_p3|linebreaksbr }}
        </div>
        
        <!-- Tabela VUS -->
        <div class="field field-p3-vus-gene txt-table">{{ vus_gene }}</div>
        <div class="field field-p3-vus-transcript txt-table">{{ vus_transcript }}</div>
        <div class="field field-p3-vus-variant-c txt-table">
            {{ vus_variant_c }} {{ vus_variant_p }}
        </div>
        <div class="field field-p3-vus-dbsnp txt-table">{{ vus_dbsnp }}</div>
        <div class="field field-p3-vus-zygosity txt-table">{{ vus_zygosity }}</div>
        <div class="field field-p3-vus-inheritance txt-table">{{ vus_inheritance }}</div>
        <div class="field field-p3-vus-classification txt-table">{{ vus_classification }}</div>
        {% include 'editor/_footer_professionals.html' %}
    </div>

    <!-- PAGE 04: GENES ANALISADOS -->
    <div class="pdf-page page-04" style="background-image: url('{{ bg_pages.3|default:'/static/editor/img/templates/laudo144_pg04.png' }}');">
        {% include 'editor/_header_patient.html' with page='p4' %}
        <div class="field field-p4-genes box txt-paragraph">
            {{ genes_analyzed_p4|linebreaksbr }}
        </div>
        {% include 'editor/_footer_professionals.html' %}
    </div>

    <!-- PAGE 05: NOTAS + RECOMENDAÇÕES + MÉTRICAS/COBERTURA -->
    <div class="pdf-page page-05" style="background-image: url('{{ bg_pages.4|default:'/static/editor/img/templates/laudo144_pg05.png' }}');">
        {% include 'editor/_header_patient.html' with page='p5' %}
        <div class="field field-p5-notes-subtitle txt-section">ACHADOS SECUNDÁRIOS</div>
        <div class="field field-p5-notes box txt-paragraph">
            {{ notes_text|linebreaks }}
        </div>
        {% if is_admin %}
        <div class="field field-p5-recommendations box txt-paragraph">
            {{ recommendations_text|linebreaksbr }}
        </div>
        {% endif %}
        <div class="field field-p5-metrics-title txt-section">DNA Nuclear</div>
        <div class="field field-p5-metrics-label-mean txt-label">Cobertura média da região alvo:</div>
        <div class="field field-p5-metrics-label-50x txt-label">% da região alvo com cobertura maior ou igual a 50x:</div>
        <div class="field field-p5-metrics-note txt-label">Região alvo refere-se a região codificante e sítios de splicing dos genes analisados.</div>
        <div class="field field-p5-coverage-mean txt-value">
            {{ metrics_coverage_mean }}
        </div>
        <div class="field field-p5-coverage-50x txt-value">
            {{ metrics_coverage_50x }}
        </div>
        {% include 'editor/_footer_professionals.html' %}
    </div>

    <!-- PAGE 06: Apenas fundo -->
    <div class="pdf-page page-06" style="background-image: url('{{ bg_pages.5|default:'/static/editor/img/templates/laudo144_pg06.png' }}');">
        {% include 'editor/_header_patient.html' with page='p6' %}
        <div class="field field-p6-methodology box txt-paragraph">
            {{ methodology_text|linebreaksbr }}
        </div>
        {% include 'editor/_footer_professionals.html' %}
    </div>

    {% if overflow_pages %}
        {% for page in overflow_pages %}
        <div class="pdf-page page-overflow" style="background-image: url('{{ bg_pages.7|default:'/static/editor/img/templates/laudo144_pg08.png' }}');">
            {% include 'editor/_header_patient.html' with page='p7' %}
            <div class="overflow-title txt-section">{{ page.title }}</div>
            <div class="overflow-body txt-paragraph">
                {{ page.text|linebreaksbr }}
            </div>
            {% include 'editor/_footer_professionals.html' %}
        </div>
        {% endfor %}
    {% else %}
        <!-- PAGE 07: Apenas fundo -->
        <div class="pdf-page page-07" style="background-image: url('{{ bg_pages.6|default:'/static/editor/img/templates/laudo144_pg07.png' }}');">
            {% include 'editor/_header_patient.html' with page='p7' %}
            {% include 'editor/_footer_professionals.html' %}
        </div>

        <!-- PAGE 08: Apenas fundo -->
        <div class="pdf-page page-08" style="background-image: url('{{ bg_pages.7|default:'/static/editor/img/templates/laudo144_pg08.png' }}');">
        </div>
    {% endif %}
</div>
